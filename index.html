<!DOCTYPE html>
<html>
<head>
	<link href="css/jquery-ui.css" rel="stylesheet">
	<link href="css/local.css" rel="stylesheet">
	<script src="js/jquery.js"></script>
	<script src="js/jquery-ui.js"></script>
    <script language="javascript" type="text/javascript">
        function resizeIframe(obj) {
            obj.style.height = obj.contentWindow.document.body.scrollHeight + 'px';
        }
    </script>
	<script src="talent_data.php"></script>
	<script src="item_data.php"></script>
</head>
<body>
<div style="display:inline-block;background-color:#757575;">
	<div id="general-info" class="general-info">
		<div style="float:left;width:250px"><a style="color:#e7a516" href="http://lsonline.ru/"><img src="http://lsonline.ru/data/images/logo.png"/></a></div>
		<div style="float:left;">
		<div style="float:none;"><span>Ссылка на билд:</span><input id="link-to-build"></input></div>
		<div>Очки навыков <span id="points-left">0</span></div>
		<div>Уровень наемника <span id="merc-level">1</span></div>
		</div>
	</div>
	<div class="talent-manager">
	<div id="tabs" style="float:left">
		<ul>
			<li><a id="assault-link" href="#tabs-as">
			Штурмовик<br/>
			<svg viewbox="0 0 128 128">
			<path id="path_assault" 
				style="fill-opacity:0.25098039;stroke-width:3;stroke-opacity:1"
				d="m 63,2 -18,36 -41,6 29,30 -6,41 37,-19 36,18 -6,-41 28,-28 -40,-6 z"/>
			</svg></a></li>
			<li><a id="juggernaut-link" href="#tabs-ju">Джаггернаут</br>
			<svg viewbox="0 0 128 128">
			<path id="path_juggernaut"
				style="fill-opacity:0.25098039;stroke-width:3;stroke-opacity:1"
				d="m 64,4 -44,9 c 0,0 -0,41 11,68 13,28 33,45 33,45 0,0 19,-15 33,-46 12,-27 10,-67 10,-67 z"/>
			</svg>
			</a></li>
			<li><a id="scout-link" href="#tabs-sc">Скаут</br>
			<svg viewbox="0 0 128 128">
			<path id="scout_path_circle"
				style="fill:none;fill-opacity:0.25098039;stroke-width:7;stroke-opacity:1"
				d="M 111,63 A 48,48 0 0 1 62,111 48,48 0 0 1 14,63 48,48 0 0 1 62,14 48,48 0 0 1 111,62" />
			<path id="scout_path_vertical"
				style="fill:none;stroke-width:4;stroke-opacity:1"
				d="M 63,-0 63,127"/>
			<path id="scout_path_horizontal"
				style="fill:none;stroke-width:4;stroke-opacity:1"
				d="m 0,63 125,0"/>
			</svg></a></li>
			<li><a id="support-link" href="#tabs-su">Поддержка</br>
			<svg viewbox="0 0 128 128">
			<path id="path_support_cross"
				style="fill-opacity:0.25098039;stroke-width:4;stroke-opacity:1"
				d="m 80,4 -32,-0 0,42 -43,0 -0,33 43,0 0,42 33,0 0,-42 42,0 0,-33 -42,-0 z"
			/>
			<path id="path_support_wrench"
				style="fill-opacity:1;stroke:none;"
				d="m 33,95 -15,-3 -11,12 -3,-0 C 2,80 23,80 34,79 L 79,33 C 79,21 80,2 103,0 l 0,4 -11,11 2,15 16,4 11,-12 4,0 c -2,22 -19,22 -32,23 L 49,94 c -1,15 -1,30 -24,33 l -0,-4 12,-12 z"/>
			</svg></a></li>
		</ul>
		<div id="tabs-as" aria-labelledby="assault-link" class="ui-tabs-panel ui-widget-content ui-corner-bottom" role="tabpanel" aria-hidden="false" style="">
			<div id="as-layout" class="talents-background">
			<canvas id='calculator-as-layout'>Your browser do not support this application</canvas>
			</div>
		</div>
		<div id="tabs-ju" aria-labelledby="juggernaut-link" class="ui-tabs-panel ui-widget-content ui-corner-bottom" role="tabpanel" aria-hidden="true" style="display: none;">
			<div id="ju-layout" class="talents-background">
			<canvas id='calculator-ju-layout'>Your browser do not support this application</canvas>
			</div>
		</div>
		<div id="tabs-sc" aria-labelledby="scout-link" class="ui-tabs-panel ui-widget-content ui-corner-bottom" role="tabpanel" aria-hidden="true" style="display: none;">
			<div id="sc-layout" class="talents-background">
			<canvas id='calculator-sc-layout'>Your browser do not support this application</canvas>
			</div>
		</div>
		<div id="tabs-su" aria-labelledby="support-link" class="ui-tabs-panel ui-widget-content ui-corner-bottom" role="tabpanel" aria-hidden="true" style="display: none;">
			<div id="su-layout" class="talents-background">
			<canvas id='calculator-su-layout'>Your browser do not support this application</canvas>
			</div>
		</div>
	</div>
	</div>
	<div class="item-manager">
	<div id="armor" class="tunable-item">
		<div class="tunable-item-name"><a target="_blank" id="armor-link"><span id="armor-name"></span><span id="armor-value"></span></a></div>
		<div style="overflow:auto;">
			<div class="draggable-landing">
				<div id="armor-container" style="overflow:auto;">
					<img src="itemspng/slot-armor.png"/>
				</div>
				<a class="tunable-reset" onclick="player_model.reset_inventory_slot('armor');">очистить</a>
			</div>
			<div style="float:left;">
				<input type="radio" name="armor-quality" value="gray" id="armor-quality-gray" class="quality">
					<label for="armor-quality-gray"><span class="gray"><span class="gray"></span></span></label>
				</input>
				<input type="radio" name="armor-quality" value="white" id="armor-quality-white" class="quality" checked>
					<label for="armor-quality-white"><span class="white"><span class="white"></span></span></label>
				</input>
				<input type="radio" name="armor-quality" value="green" id="armor-quality-green" class="quality">
					<label for="armor-quality-green"><span class="green"><span class="green"></span></span></label>
				</input>
				<input type="radio" name="armor-quality" value="blue" id="armor-quality-blue" class="quality">
					<label for="armor-quality-blue"><span class="blue"><span class="blue"></span></span></label>
				</input>
				<div id="armor-slider" style="clear:both;"></div>
			</div>
		</div>
		<div class="fake-tooltip-container">
			<div class="fake-tooltip" id="armor-fake-tooltip"></div>
		</div>
	</div>
	<div id="primary" class="tunable-item">
		<div class="tunable-item-name"><a target="_blank" id="primary-link"><span id="primary-name"></span><span id="primary-value"></span></a></div>
		<div style="overflow:auto;">
			<div class="draggable-landing">
				<div id="primary-container" style="overflow:auto;">
					<img src="itemspng/slot-primary.png"/>
				</div>
				<a class="tunable-reset" onclick="player_model.reset_inventory_slot('primary');">очистить</a>
			</div>
			<div style="float:left;">
				<input type="radio" name="primary-quality" value="gray" id="primary-quality-gray" class="quality">
					<label for="primary-quality-gray"><span class="gray"><span class="gray"></span></span></label>
				</input>
				<input type="radio" name="primary-quality" value="white" id="primary-quality-white" class="quality" checked>
					<label for="primary-quality-white"><span class="white"><span class="white"></span></span></label>
				</input>
				<input type="radio" name="primary-quality" value="green" id="primary-quality-green" class="quality">
					<label for="primary-quality-green"><span class="green"><span class="green"></span></span></label>
				</input>
				<input type="radio" name="primary-quality" value="blue" id="primary-quality-blue" class="quality">
					<label for="primary-quality-blue"><span class="blue"><span class="blue"></span></span></label>
				</input>
				<div id="primary-slider" style="clear:both;"></div>
			</div>
		</div>
		<div class="fake-tooltip-container">
			<div class="fake-tooltip" id="primary-fake-tooltip"></div>
		</div>
	</div>
	<div id="secondary" class="tunable-item">
		<div class="tunable-item-name"><a target="_blank" id="secondary-link"><span id="secondary-name"></span><span id="secondary-value"></span></a></div>
		<div style="overflow:auto;">
			<div class="draggable-landing">
				<div id="secondary-container" style="overflow:auto;">
					<img src="itemspng/slot-secondary.png"/>
				</div>
				<a class="tunable-reset" onclick="player_model.reset_inventory_slot('secondary');">очистить</a>
			</div>
			<div style="float:left;">
				<input type="radio" name="secondary-quality" value="gray" id="secondary-quality-gray" class="quality">
					<label for="secondary-quality-gray"><span class="gray"><span class="gray"></span></span></label>
				</input>
				<input type="radio" name="secondary-quality" value="white" id="secondary-quality-white" class="quality" checked>
					<label for="secondary-quality-white"><span class="white"><span class="white"></span></span></label>
				</input>
				<input type="radio" name="secondary-quality" value="green" id="secondary-quality-green" class="quality">
					<label for="secondary-quality-green"><span class="green"><span class="green"></span></span></label>
				</input>
				<input type="radio" name="secondary-quality" value="blue" id="secondary-quality-blue" class="quality">
					<label for="secondary-quality-blue"><span class="blue"><span class="blue"></span></span></label>
				</input>
				<div id="secondary-slider" style="clear:both;"></div>
			</div>
		</div>
		<div class="fake-tooltip-container">
			<div class="fake-tooltip" id="secondary-fake-tooltip"></div>
		</div>
	</div>
	<div id="special-items" class="special-item-container">
		<div class="special-item">
			<a id="hat-link" target="_blank" class="white-link" style="margin:3px;">ссылка</a>
			<div id="hat-container">
				<img src="itemspng/slot-hat.png"/>
			</div>
			<a class="tunable-reset" onclick="player_model.reset_inventory_slot('hat');">очистить</a>
			<div class="fake-tooltip-container">
				<div class="fake-tooltip" id="hat-fake-tooltip"></div>
			</div>
		</div>
		<div class="special-item">
			<a id="consumable_1-link" target="_blank" class="white-link" style="margin:3px;">ссылка</a>
			<div id="consumable_1-container">
				<img src="itemspng/slot-consumable_1.png"/>
			</div>
			<a class="tunable-reset" onclick="player_model.reset_inventory_slot('consumable_1');">очистить</a>
			<div class="fake-tooltip-container">
				<div class="fake-tooltip" id="consumable_1-fake-tooltip"></div>
			</div>
		</div>
		<div class="special-item">
			<a id="consumable_2-link" target="_blank" class="white-link" style="margin:3px;">ссылка</a>
			<div id="consumable_2-container">
				<img src="itemspng/slot-consumable_2.png"/>
			</div>
			<a class="tunable-reset" onclick="player_model.reset_inventory_slot('consumable_2');">очистить</a>
			<div class="fake-tooltip-container">
				<div class="fake-tooltip" id="consumable_2-fake-tooltip"></div>
			</div>
		</div>
		<div class="special-item">
			<a id="consumable_3-link" target="_blank" class="white-link" style="margin:3px;">ссылка</a>
			<div id="consumable_3-container">
				<img src="itemspng/slot-consumable_3.png"/>
			</div>
			<a class="tunable-reset" onclick="player_model.reset_inventory_slot('consumable_3');">очистить</a>
			<div class="fake-tooltip-container">
				<div class="fake-tooltip" id="consumable_3-fake-tooltip"></div>
			</div>
		</div>
		<div class="special-item">
			<a id="consumable_4-link" target="_blank" class="white-link" style="margin:3px;">ссылка</a>
			<div id="consumable_4-container">
				<img src="itemspng/slot-consumable_4.png"/>
			</div>
			<a class="tunable-reset" onclick="player_model.reset_inventory_slot('consumable_4');">очистить</a>
			<div class="fake-tooltip-container">
				<div class="fake-tooltip" id="consumable_4-fake-tooltip"></div>
			</div>
		</div>
		<div class="special-item">
			<a id="consumable_5-link" target="_blank" class="white-link" style="margin:3px;">ссылка</a>
			<div id="consumable_5-container">
				<img src="itemspng/slot-consumable_5.png"/>
			</div>
			<a class="tunable-reset" onclick="player_model.reset_inventory_slot('consumable_5');">очистить</a>
			<div class="fake-tooltip-container">
				<div class="fake-tooltip" id="consumable_5-fake-tooltip"></div>
			</div>
		</div>
	</div>
	<div id="items-pool" style="clear:both;overflow:auto;">
		<ul>
			<li><a href="#all-armor">Броня</a></li>
			<li><a href="#all-melee">Ближний бой</a></li>
			<li><a href="#all-pistol">Пистолеты</a></li>
			<li><a href="#all-smg">ПП</a></li>
			<li><a href="#all-shotgun">Дробовики</a></li>
			<li><a href="#all-assault-rifle">Автоматы</a></li>
			<li><a href="#all-sniper-rifle">Снайперское</a></li>
			<li><a href="#all-machinegun">Пулеметы</a></li>
			<li><a href="#all-launcher">Взрывное</a></li>
			<li><a href="#all-shield">Щиты</a></li>
			<li><a href="#all-hat">Шапки</a></li>
			<li><a href="#all-consumable">Активки</a></li>
		</ul>
		<div id="all-armor">
			<div id="armor-pool" class="pool"></div>
		</div>
		<div id="all-melee">
			<div id="melee-pool" class="pool"></div>
		</div>
		<div id="all-pistol">
			<div id="pistol-pool" class="pool"></div>
		</div>
		<div id="all-smg">
			<div id="smg-pool" class="pool"></div>
		</div>
		<div id="all-shotgun">
			<div id="shotgun-pool" class="pool"></div>
		</div>
		<div id="all-assault-rifle">
			<div id="assault_rifle-pool" class="pool"></div>
		</div>
		<div id="all-sniper-rifle">
			<div id="sniper_rifle-pool" class="pool"></div>
		</div>
		<div id="all-machinegun">
			<div id="machinegun-pool" class="pool"></div>
		</div>
		<div id="all-launcher">
			<div id="launcher-pool" class="pool"></div>
		</div>
		<div id="all-shield">
			<div id="shield-pool" class="pool"></div>
		</div>
		<div id="all-hat">
			<div id="hat-pool" class="pool"></div>
		</div>
		<div id="all-consumable">
			<div id="consumable-pool" class="pool"></div>
		</div>
	</div>
	</div>
	</div>
<script>
$("#items-pool").tabs();
$( "#tabs" ).tabs();
$( "#tabs li" ).removeClass( "ui-corner-top" ).addClass( "ui-corner-left" );
</script>

<script src="js/talent-calculator.js"></script>
<script src="js/logic.js"></script>
<script src="js/calculator.js"></script>
<script>
var sources = {
	atlasActive: "Skills.png",
	atlasInactive: "inactiveSkills.png"
};
function prepareCalculator(calculator) {
	calculator.calculateWidth();
	calculator.fillHeightMap();
	calculator.mapRefsReqs();
	calculator.mapRanks();
	calculator.arrangeRows(5,3,35,50);
	$("#calculator-" + calculator.prefix + "-layout").prop("width", calculator.totalWidth);
	$("#calculator-" + calculator.prefix + "-layout").prop("height", calculator.totalHeight);
}
function prepareController(controller) {
	controller.drawBackground();
	controller.markRows();
	controller.drawReqToRefLinks();
	controller.drawTalents();
}
loadImages(sources, function(images) {
	var asCalculator = new Calculator(patchdata.assault_data);
	prepareCalculator(asCalculator);
	var element = document.getElementById("calculator-as-layout");
	var ctx = element.getContext('2d');
	var asController = new Controller(asCalculator, ctx, images.atlasActive, images.atlasInactive);
	prepareController(asController);
	$("#calculator-as-layout").click(function(e) {
		asController.handleClick(e.offsetX, e.offsetY);
		player_model.update_link(asCalculator.getTalentString());
		talent_grid_model.update_requirements_layout(asCalculator.getRequiredLevel(), asCalculator.getAvailableTalentPoints());
	});
	$("#calculator-as-layout").mousemove(function(e) {
		var offset = $(this).offset();
		asController.handleMouseMove(e.pageX - offset.left, e.pageY - offset.top);
	});
	
	var juCalculator = new Calculator(patchdata.juggernaut_data);
	prepareCalculator(juCalculator);
	element = document.getElementById("calculator-ju-layout");
	ctx = element.getContext('2d');
	var juController = new Controller(juCalculator, ctx, images.atlasActive, images.atlasInactive);
	prepareController(juController);
	$("#calculator-ju-layout").click(function(e) {
		juController.handleClick(e.offsetX, e.offsetY);
		player_model.update_link(juCalculator.getTalentString());
		talent_grid_model.update_requirements_layout(juCalculator.getRequiredLevel(), juCalculator.getAvailableTalentPoints());
	});
	$("#calculator-ju-layout").mousemove(function(e) {
		var offset = $(this).offset();
		juController.handleMouseMove(e.pageX - offset.left, e.pageY - offset.top);
	});
	
	var scCalculator = new Calculator(patchdata.scout_data);
	prepareCalculator(scCalculator);
	element = document.getElementById("calculator-sc-layout");
	ctx = element.getContext('2d');
	var scController = new Controller(scCalculator, ctx, images.atlasActive, images.atlasInactive);
	prepareController(scController);
	$("#calculator-sc-layout").click(function(e) {
		scController.handleClick(e.offsetX, e.offsetY);
		player_model.update_link(scCalculator.getTalentString());
		talent_grid_model.update_requirements_layout(scCalculator.getRequiredLevel(), scCalculator.getAvailableTalentPoints());
	});
	$("#calculator-sc-layout").mousemove(function(e) {
		var offset = $(this).offset();
		scController.handleMouseMove(e.pageX - offset.left, e.pageY - offset.top);
	});
	
	var suCalculator = new Calculator(patchdata.support_data);
	prepareCalculator(suCalculator);
	element = document.getElementById("calculator-su-layout");
	ctx = element.getContext('2d');
	var suController = new Controller(suCalculator, ctx, images.atlasActive, images.atlasInactive);
	prepareController(suController);
	$("#calculator-su-layout").click(function(e) {
		suController.handleClick(e.offsetX, e.offsetY);
		player_model.update_link(suCalculator.getTalentString());
		talent_grid_model.update_requirements_layout(suCalculator.getRequiredLevel(), suCalculator.getAvailableTalentPoints());
	});
	$("#calculator-su-layout").mousemove(function(e) {
		var offset = $(this).offset();
		suController.handleMouseMove(e.pageX - offset.left, e.pageY - offset.top);
	});
});

</script>
<script src="js/analytics.js"></script>
</body>
</html>